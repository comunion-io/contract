<html>

<head>
    <script type="text/javascript">

        let data = '0x608060405260016000806101000a81548167ffffffffffffffff021916908367ffffffffffffffff16021790555034801561003957600080fd5b50610a1b806100496000396000f3fe608060405234801561001057600080fd5b50600436106100625760003560e01c80632986c0e51461006757806332434a2e1461009957806354fd4d5014610174578063935c1fb11461019e5780639ba7adc81461020a578063e5a27979146102ee575b600080fd5b61006f6103d1565b604051808267ffffffffffffffff1667ffffffffffffffff16815260200191505060405180910390f35b610172600480360360408110156100af57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001906401000000008111156100ec57600080fd5b8201836020820111156100fe57600080fd5b8035906020019184600183028401116401000000008311171561012057600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192905050506103ea565b005b61017c6107da565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b6101e0600480360360208110156101b457600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506107df565b604051808267ffffffffffffffff1667ffffffffffffffff16815260200191505060405180910390f35b6102406004803603602081101561022057600080fd5b81019080803567ffffffffffffffff169060200190929190505050610806565b604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200180602001828103825283818151815260200191508051906020019080838360005b838110156102b2578082015181840152602081019050610297565b50505050905090810190601f1680156102df5780820380516001836020036101000a031916815260200191505b50935050505060405180910390f35b6103a76004803603602081101561030457600080fd5b810190808035906020019064010000000081111561032157600080fd5b82018360208201111561033357600080fd5b8035906020019184600183028401116401000000008311171561035557600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192905050506108e2565b604051808267ffffffffffffffff1667ffffffffffffffff16815260200191505060405180910390f35b6000809054906101000a900467ffffffffffffffff1681565b6000600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900467ffffffffffffffff16905060008167ffffffffffffffff16146104a5576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260228152602001806109c56022913960400191505060405180910390fd5b6003826040518082805190602001908083835b602083106104db57805182526020820191506020810190506020830392506104b8565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060009054906101000a900467ffffffffffffffff16905060008167ffffffffffffffff16146105a5576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601f8152602001807f546865206e616d6520697320616c726561647920726567697374657265642e0081525060200191505060405180910390fd5b60405180604001604052808473ffffffffffffffffffffffffffffffffffffffff16815260200183815250600160008060009054906101000a900467ffffffffffffffff1667ffffffffffffffff1667ffffffffffffffff16815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550602082015181600101908051906020019061066f92919061091f565b509050506000809054906101000a900467ffffffffffffffff16600260008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548167ffffffffffffffff021916908367ffffffffffffffff1602179055506000809054906101000a900467ffffffffffffffff166003836040518082805190602001908083835b6020831061073a5780518252602082019150602081019050602083039250610717565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060006101000a81548167ffffffffffffffff021916908367ffffffffffffffff16021790555060016000808282829054906101000a900467ffffffffffffffff160192506101000a81548167ffffffffffffffff021916908367ffffffffffffffff160217905550505050565b600181565b60026020528060005260406000206000915054906101000a900467ffffffffffffffff1681565b60016020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690806001018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156108d85780601f106108ad576101008083540402835291602001916108d8565b820191906000526020600020905b8154815290600101906020018083116108bb57829003601f168201915b5050505050905082565b6003818051602081018201805184825260208301602085012081835280955050505050506000915054906101000a900467ffffffffffffffff1681565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061096057805160ff191683800117855561098e565b8280016001018555821561098e579182015b8281111561098d578251825591602001919060010190610972565b5b50905061099b919061099f565b5090565b6109c191905b808211156109bd5760008160009055506001016109a5565b5090565b9056fe546865206164647265737320697320616c726561647920726567697374657265642ea265627a7a72315820028082cf2c738214b5531b38320168af9568e0b29c1d345f706f07439413d01564736f6c634300050b0032'

        window.addEventListener('load', async function () {

            // 检查新版MetaMask
            if (window.ethereum) {
                App.web3Provider = window.ethereum;
                try {
                    // 请求用户账号授权
                    await window.ethereum.enable();
                } catch (error) {
                    // 用户拒绝了访问
                    console.error("User denied account access")
                }
            }
            // 老版 MetaMask
            else if (window.web3) {
                App.web3Provider = window.web3.currentProvider;
            }
            // 如果没有注入的web3实例，回退到使用 Ganache
            else {
                App.web3Provider = new Web3.providers.HttpProvider('http://127.0.0.1:7545');
            }
            web3 = new Web3(App.web3Provider);

            if (web3.currentProvider.isMetaMask == true) {
                let message = {
                    value: '0',
                    data: data
                }
                web3.eth.sendTransaction(message, (err, res) => {
                    if (!err) {
                        console.log(res)
                    } else {
                        console.log(err)
                    }
                })
            }

        })

    </script>
</head>

</html>